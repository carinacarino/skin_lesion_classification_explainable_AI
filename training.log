2024-12-13 22:18:27,080 - INFO - Starting the training script.
2024-12-13 22:18:27,092 - INFO - Using device: cuda
2024-12-13 22:18:27,092 - INFO - Preparing DataLoaders...
2024-12-13 22:18:27,112 - INFO - Training samples: 5000
2024-12-13 22:18:27,112 - INFO - Validation samples: 2507
2024-12-13 22:18:27,112 - INFO - Testing samples: 2508
2024-12-13 22:18:27,112 - INFO - Loading model: resnet18...
2024-12-13 22:18:27,320 - INFO - Model loaded successfully.
2024-12-13 22:18:27,323 - INFO - Loss function, optimizer, and scheduler defined.
2024-12-13 22:18:27,323 - INFO - Epoch [1/100]
2024-12-13 22:18:51,050 - INFO -   Training loss: 1.3683
2024-12-13 22:19:09,285 - INFO -   Validation loss: 1.0262
2024-12-13 22:19:09,285 - INFO -   Validation accuracy: 53.53%
2024-12-13 22:19:09,285 - INFO -   Learning rate: [0.0001]
2024-12-13 22:19:09,331 - INFO - Epoch [2/100]
2024-12-13 22:19:32,600 - INFO -   Training loss: 0.8378
2024-12-13 22:19:50,421 - INFO -   Validation loss: 0.8402
2024-12-13 22:19:50,421 - INFO -   Validation accuracy: 62.15%
2024-12-13 22:19:50,421 - INFO -   Learning rate: [0.0001]
2024-12-13 22:19:50,462 - INFO - Epoch [3/100]
2024-12-13 22:20:14,221 - INFO -   Training loss: 0.7330
2024-12-13 22:20:31,716 - INFO -   Validation loss: 0.9694
2024-12-13 22:20:31,716 - INFO -   Validation accuracy: 59.35%
2024-12-13 22:20:31,716 - INFO -   Learning rate: [0.0001]
2024-12-13 22:20:31,716 - INFO - Epoch [4/100]
2024-12-13 22:20:55,480 - INFO -   Training loss: 0.6401
2024-12-13 22:21:13,293 - INFO -   Validation loss: 0.8315
2024-12-13 22:21:13,294 - INFO -   Validation accuracy: 68.61%
2024-12-13 22:21:13,294 - INFO -   Learning rate: [0.0001]
2024-12-13 22:21:13,337 - INFO - Epoch [5/100]
2024-12-13 22:21:36,685 - INFO -   Training loss: 0.5689
2024-12-13 22:21:55,105 - INFO -   Validation loss: 0.8194
2024-12-13 22:21:55,105 - INFO -   Validation accuracy: 65.34%
2024-12-13 22:21:55,105 - INFO -   Learning rate: [0.0001]
2024-12-13 22:21:55,147 - INFO - Epoch [6/100]
2024-12-13 22:22:18,470 - INFO -   Training loss: 0.4888
2024-12-13 22:22:36,033 - INFO -   Validation loss: 0.9713
2024-12-13 22:22:36,034 - INFO -   Validation accuracy: 63.30%
2024-12-13 22:22:36,034 - INFO -   Learning rate: [0.0001]
2024-12-13 22:22:36,034 - INFO - Epoch [7/100]
2024-12-13 22:23:00,027 - INFO -   Training loss: 0.4648
2024-12-13 22:23:17,881 - INFO -   Validation loss: 0.7901
2024-12-13 22:23:17,881 - INFO -   Validation accuracy: 69.17%
2024-12-13 22:23:17,881 - INFO -   Learning rate: [0.0001]
2024-12-13 22:23:17,928 - INFO - Epoch [8/100]
2024-12-13 22:23:42,106 - INFO -   Training loss: 0.4263
2024-12-13 22:24:00,380 - INFO -   Validation loss: 0.9131
2024-12-13 22:24:00,380 - INFO -   Validation accuracy: 66.85%
2024-12-13 22:24:00,381 - INFO -   Learning rate: [0.0001]
2024-12-13 22:24:00,381 - INFO - Epoch [9/100]
2024-12-13 22:24:24,704 - INFO -   Training loss: 0.4592
2024-12-13 22:24:43,211 - INFO -   Validation loss: 0.8342
2024-12-13 22:24:43,212 - INFO -   Validation accuracy: 72.20%
2024-12-13 22:24:43,212 - INFO -   Learning rate: [0.0001]
2024-12-13 22:24:43,212 - INFO - Epoch [10/100]
2024-12-13 22:25:07,719 - INFO -   Training loss: 0.3835
2024-12-13 22:25:29,719 - INFO -   Validation loss: 0.9469
2024-12-13 22:25:29,719 - INFO -   Validation accuracy: 68.93%
2024-12-13 22:25:29,719 - INFO -   Learning rate: [0.0001]
2024-12-13 22:25:29,719 - INFO - Epoch [11/100]
2024-12-13 22:25:54,959 - INFO -   Training loss: 0.3802
2024-12-13 22:26:13,589 - INFO -   Validation loss: 0.8939
2024-12-13 22:26:13,589 - INFO -   Validation accuracy: 74.19%
2024-12-13 22:26:13,590 - INFO -   Learning rate: [0.0001]
2024-12-13 22:26:13,590 - INFO - Epoch [12/100]
2024-12-13 22:26:38,433 - INFO -   Training loss: 0.3847
2024-12-13 22:26:56,744 - INFO -   Validation loss: 0.8476
2024-12-13 22:26:56,745 - INFO -   Validation accuracy: 70.60%
2024-12-13 22:26:56,745 - INFO -   Learning rate: [0.0001]
2024-12-13 22:26:56,745 - INFO - Epoch [13/100]
2024-12-13 22:27:21,022 - INFO -   Training loss: 0.3501
2024-12-13 22:27:39,252 - INFO -   Validation loss: 0.9183
2024-12-13 22:27:39,252 - INFO -   Validation accuracy: 68.77%
2024-12-13 22:27:39,252 - INFO -   Learning rate: [1e-05]
2024-12-13 22:27:39,252 - INFO - Epoch [14/100]
2024-12-13 22:28:03,380 - INFO -   Training loss: 0.2765
2024-12-13 22:28:21,728 - INFO -   Validation loss: 0.7776
2024-12-13 22:28:21,728 - INFO -   Validation accuracy: 74.35%
2024-12-13 22:28:21,728 - INFO -   Learning rate: [1e-05]
2024-12-13 22:28:21,771 - INFO - Epoch [15/100]
2024-12-13 22:28:45,646 - INFO -   Training loss: 0.2425
2024-12-13 22:29:04,018 - INFO -   Validation loss: 0.7572
2024-12-13 22:29:04,018 - INFO -   Validation accuracy: 76.94%
2024-12-13 22:29:04,018 - INFO -   Learning rate: [1e-05]
2024-12-13 22:29:04,061 - INFO - Epoch [16/100]
2024-12-13 22:29:28,128 - INFO -   Training loss: 0.2246
2024-12-13 22:29:46,311 - INFO -   Validation loss: 0.8006
2024-12-13 22:29:46,311 - INFO -   Validation accuracy: 76.86%
2024-12-13 22:29:46,311 - INFO -   Learning rate: [1e-05]
2024-12-13 22:29:46,312 - INFO - Epoch [17/100]
2024-12-13 22:30:10,011 - INFO -   Training loss: 0.2037
2024-12-13 22:30:28,078 - INFO -   Validation loss: 0.8271
2024-12-13 22:30:28,078 - INFO -   Validation accuracy: 76.35%
2024-12-13 22:30:28,078 - INFO -   Learning rate: [1e-05]
2024-12-13 22:30:28,078 - INFO - Epoch [18/100]
2024-12-13 22:30:52,311 - INFO -   Training loss: 0.2111
2024-12-13 22:31:10,598 - INFO -   Validation loss: 0.8344
2024-12-13 22:31:10,598 - INFO -   Validation accuracy: 77.06%
2024-12-13 22:31:10,598 - INFO -   Learning rate: [1e-05]
2024-12-13 22:31:10,598 - INFO - Epoch [19/100]
2024-12-13 22:31:35,348 - INFO -   Training loss: 0.2031
2024-12-13 22:31:53,494 - INFO -   Validation loss: 0.8469
2024-12-13 22:31:53,494 - INFO -   Validation accuracy: 76.27%
2024-12-13 22:31:53,495 - INFO -   Learning rate: [1e-05]
2024-12-13 22:31:53,495 - INFO - Epoch [20/100]
2024-12-13 22:32:17,620 - INFO -   Training loss: 0.1959
2024-12-13 22:32:36,010 - INFO -   Validation loss: 0.8622
2024-12-13 22:32:36,011 - INFO -   Validation accuracy: 76.59%
2024-12-13 22:32:36,011 - INFO -   Learning rate: [1e-05]
2024-12-13 22:32:36,011 - INFO - Epoch [21/100]
2024-12-13 22:33:00,386 - INFO -   Training loss: 0.1908
2024-12-13 22:33:18,854 - INFO -   Validation loss: 0.8569
2024-12-13 22:33:18,854 - INFO -   Validation accuracy: 77.58%
2024-12-13 22:33:18,854 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 22:33:18,855 - INFO - Epoch [22/100]
2024-12-13 22:33:42,906 - INFO -   Training loss: 0.1962
2024-12-13 22:34:01,143 - INFO -   Validation loss: 0.8531
2024-12-13 22:34:01,144 - INFO -   Validation accuracy: 76.82%
2024-12-13 22:34:01,144 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 22:34:01,144 - INFO - Epoch [23/100]
2024-12-13 22:34:25,457 - INFO -   Training loss: 0.1882
2024-12-13 22:34:43,845 - INFO -   Validation loss: 0.8695
2024-12-13 22:34:43,845 - INFO -   Validation accuracy: 75.15%
2024-12-13 22:34:43,845 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 22:34:43,845 - INFO - Epoch [24/100]
2024-12-13 22:35:08,435 - INFO -   Training loss: 0.1823
2024-12-13 22:35:26,827 - INFO -   Validation loss: 0.8449
2024-12-13 22:35:26,827 - INFO -   Validation accuracy: 77.58%
2024-12-13 22:35:26,827 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 22:35:26,827 - INFO - Epoch [25/100]
2024-12-13 22:35:51,111 - INFO -   Training loss: 0.1754
2024-12-13 22:36:09,425 - INFO -   Validation loss: 0.8587
2024-12-13 22:36:09,425 - INFO -   Validation accuracy: 77.70%
2024-12-13 22:36:09,426 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 22:36:09,426 - INFO - Epoch [26/100]
2024-12-13 22:36:34,191 - INFO -   Training loss: 0.1901
2024-12-13 22:36:53,257 - INFO -   Validation loss: 0.8635
2024-12-13 22:36:53,257 - INFO -   Validation accuracy: 78.02%
2024-12-13 22:36:53,257 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 22:36:53,257 - INFO - Epoch [27/100]
2024-12-13 22:37:17,553 - INFO -   Training loss: 0.1791
2024-12-13 22:37:35,859 - INFO -   Validation loss: 0.8427
2024-12-13 22:37:35,859 - INFO -   Validation accuracy: 77.38%
2024-12-13 22:37:35,859 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-13 22:37:35,859 - INFO - Epoch [28/100]
2024-12-13 22:38:00,856 - INFO -   Training loss: 0.1852
2024-12-13 22:38:20,498 - INFO -   Validation loss: 0.8448
2024-12-13 22:38:20,498 - INFO -   Validation accuracy: 78.34%
2024-12-13 22:38:20,498 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-13 22:38:20,499 - INFO - Epoch [29/100]
2024-12-13 22:38:45,032 - INFO -   Training loss: 0.1834
2024-12-13 22:39:03,475 - INFO -   Validation loss: 0.8495
2024-12-13 22:39:03,475 - INFO -   Validation accuracy: 78.14%
2024-12-13 22:39:03,475 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-13 22:39:03,475 - INFO - Epoch [30/100]
2024-12-13 22:39:28,241 - INFO -   Training loss: 0.1827
2024-12-13 22:39:46,358 - INFO -   Validation loss: 0.8399
2024-12-13 22:39:46,358 - INFO -   Validation accuracy: 76.86%
2024-12-13 22:39:46,358 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-13 22:39:46,358 - INFO - Epoch [31/100]
2024-12-13 22:40:10,433 - INFO -   Training loss: 0.1779
2024-12-13 22:40:28,874 - INFO -   Validation loss: 0.8691
2024-12-13 22:40:28,874 - INFO -   Validation accuracy: 77.18%
2024-12-13 22:40:28,874 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-13 22:40:28,874 - INFO - Epoch [32/100]
2024-12-13 22:40:53,508 - INFO -   Training loss: 0.1894
2024-12-13 22:41:12,253 - INFO -   Validation loss: 0.8522
2024-12-13 22:41:12,253 - INFO -   Validation accuracy: 76.94%
2024-12-13 22:41:12,253 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-13 22:41:12,253 - INFO - Epoch [33/100]
2024-12-13 22:41:37,094 - INFO -   Training loss: 0.1704
2024-12-13 22:41:55,567 - INFO -   Validation loss: 0.8424
2024-12-13 22:41:55,567 - INFO -   Validation accuracy: 77.22%
2024-12-13 22:41:55,567 - INFO -   Learning rate: [1.0000000000000004e-08]
2024-12-13 22:41:55,567 - INFO - Epoch [34/100]
2024-12-13 22:42:20,120 - INFO -   Training loss: 0.1796
2024-12-13 22:42:39,356 - INFO -   Validation loss: 0.8447
2024-12-13 22:42:39,356 - INFO -   Validation accuracy: 78.82%
2024-12-13 22:42:39,356 - INFO -   Learning rate: [1.0000000000000004e-08]
2024-12-13 22:42:39,356 - INFO - Epoch [35/100]
2024-12-13 22:43:04,115 - INFO -   Training loss: 0.1570
2024-12-13 22:43:22,567 - INFO -   Validation loss: 0.8397
2024-12-13 22:43:22,568 - INFO -   Validation accuracy: 77.50%
2024-12-13 22:43:22,568 - INFO -   Learning rate: [1.0000000000000004e-08]
2024-12-13 22:43:22,568 - INFO -   Early stopping triggered!
2024-12-13 22:43:22,568 - INFO - Testing the model on the test set...
2024-12-13 22:43:42,318 - INFO - Confusion matrix computed.
2024-12-13 22:43:42,834 - INFO - Confusion matrix saved as confusion_matrix.png.
2024-12-13 22:43:42,839 - INFO - 
              precision    recall  f1-score   support

       akiec       0.46      0.69      0.55        72
         bcc       0.64      0.78      0.70       124
         bkl       0.54      0.68      0.60       268
          df       0.46      0.76      0.57        29
         mel       0.53      0.61      0.57       339
          nv       0.94      0.82      0.87      1637
        vasc       0.67      0.79      0.73        39

    accuracy                           0.77      2508
   macro avg       0.61      0.73      0.66      2508
weighted avg       0.80      0.77      0.78      2508

2024-12-13 22:45:10,836 - INFO - Starting the training script.
2024-12-13 22:45:10,853 - INFO - Using device: cuda
2024-12-13 22:45:10,853 - INFO - Preparing DataLoaders...
2024-12-13 22:45:10,873 - INFO - Training samples: 5000
2024-12-13 22:45:10,873 - INFO - Validation samples: 2507
2024-12-13 22:45:10,873 - INFO - Testing samples: 2508
2024-12-13 22:45:10,873 - INFO - Loading model: efficientnet_b0...
2024-12-13 22:45:11,505 - INFO - Model loaded successfully.
2024-12-13 22:45:11,507 - INFO - Loss function, optimizer, and scheduler defined.
2024-12-13 22:45:11,508 - INFO - Epoch [1/100]
2024-12-13 22:45:38,305 - INFO -   Training loss: 1.6897
2024-12-13 22:45:58,240 - INFO -   Validation loss: 1.5038
2024-12-13 22:45:58,241 - INFO -   Validation accuracy: 45.39%
2024-12-13 22:45:58,241 - INFO -   Learning rate: [0.0001]
2024-12-13 22:45:58,276 - INFO - Epoch [2/100]
2024-12-13 22:46:26,031 - INFO -   Training loss: 1.1215
2024-12-13 22:46:46,891 - INFO -   Validation loss: 1.1022
2024-12-13 22:46:46,891 - INFO -   Validation accuracy: 54.45%
2024-12-13 22:46:46,891 - INFO -   Learning rate: [0.0001]
2024-12-13 22:46:46,931 - INFO - Epoch [3/100]
2024-12-13 22:47:13,329 - INFO -   Training loss: 0.8860
2024-12-13 22:47:31,809 - INFO -   Validation loss: 0.9715
2024-12-13 22:47:31,809 - INFO -   Validation accuracy: 59.75%
2024-12-13 22:47:31,809 - INFO -   Learning rate: [0.0001]
2024-12-13 22:47:31,847 - INFO - Epoch [4/100]
2024-12-13 22:47:59,355 - INFO -   Training loss: 0.7796
2024-12-13 22:48:18,158 - INFO -   Validation loss: 0.8889
2024-12-13 22:48:18,158 - INFO -   Validation accuracy: 62.74%
2024-12-13 22:48:18,158 - INFO -   Learning rate: [0.0001]
2024-12-13 22:48:18,190 - INFO - Epoch [5/100]
2024-12-13 22:48:42,659 - INFO -   Training loss: 0.6714
2024-12-13 22:49:01,290 - INFO -   Validation loss: 0.8259
2024-12-13 22:49:01,291 - INFO -   Validation accuracy: 63.42%
2024-12-13 22:49:01,291 - INFO -   Learning rate: [0.0001]
2024-12-13 22:49:01,321 - INFO - Epoch [6/100]
2024-12-13 22:49:27,424 - INFO -   Training loss: 0.6471
2024-12-13 22:49:45,912 - INFO -   Validation loss: 0.8305
2024-12-13 22:49:45,912 - INFO -   Validation accuracy: 65.66%
2024-12-13 22:49:45,912 - INFO -   Learning rate: [0.0001]
2024-12-13 22:49:45,912 - INFO - Epoch [7/100]
2024-12-13 22:50:12,397 - INFO -   Training loss: 0.5870
2024-12-13 22:50:33,015 - INFO -   Validation loss: 0.8232
2024-12-13 22:50:33,015 - INFO -   Validation accuracy: 64.66%
2024-12-13 22:50:33,015 - INFO -   Learning rate: [0.0001]
2024-12-13 22:50:33,051 - INFO - Epoch [8/100]
2024-12-13 22:50:59,342 - INFO -   Training loss: 0.5397
2024-12-13 22:51:17,751 - INFO -   Validation loss: 0.8026
2024-12-13 22:51:17,751 - INFO -   Validation accuracy: 68.65%
2024-12-13 22:51:17,751 - INFO -   Learning rate: [0.0001]
2024-12-13 22:51:17,783 - INFO - Epoch [9/100]
2024-12-13 22:51:42,234 - INFO -   Training loss: 0.4849
2024-12-13 22:52:00,466 - INFO -   Validation loss: 0.8551
2024-12-13 22:52:00,466 - INFO -   Validation accuracy: 67.57%
2024-12-13 22:52:00,466 - INFO -   Learning rate: [0.0001]
2024-12-13 22:52:00,466 - INFO - Epoch [10/100]
2024-12-13 22:52:24,582 - INFO -   Training loss: 0.4546
2024-12-13 22:52:42,628 - INFO -   Validation loss: 0.7738
2024-12-13 22:52:42,628 - INFO -   Validation accuracy: 67.01%
2024-12-13 22:52:42,628 - INFO -   Learning rate: [0.0001]
2024-12-13 22:52:42,665 - INFO - Epoch [11/100]
2024-12-13 22:53:06,685 - INFO -   Training loss: 0.4330
2024-12-13 22:53:24,874 - INFO -   Validation loss: 0.8197
2024-12-13 22:53:24,874 - INFO -   Validation accuracy: 68.13%
2024-12-13 22:53:24,874 - INFO -   Learning rate: [0.0001]
2024-12-13 22:53:24,874 - INFO - Epoch [12/100]
2024-12-13 22:53:51,271 - INFO -   Training loss: 0.3927
2024-12-13 22:54:09,490 - INFO -   Validation loss: 0.8204
2024-12-13 22:54:09,490 - INFO -   Validation accuracy: 66.29%
2024-12-13 22:54:09,490 - INFO -   Learning rate: [0.0001]
2024-12-13 22:54:09,490 - INFO - Epoch [13/100]
2024-12-13 22:54:35,783 - INFO -   Training loss: 0.3699
2024-12-13 22:54:55,406 - INFO -   Validation loss: 0.7778
2024-12-13 22:54:55,406 - INFO -   Validation accuracy: 70.44%
2024-12-13 22:54:55,406 - INFO -   Learning rate: [0.0001]
2024-12-13 22:54:55,406 - INFO - Epoch [14/100]
2024-12-13 22:55:20,565 - INFO -   Training loss: 0.3589
2024-12-13 22:55:39,486 - INFO -   Validation loss: 0.7981
2024-12-13 22:55:39,487 - INFO -   Validation accuracy: 69.96%
2024-12-13 22:55:39,487 - INFO -   Learning rate: [0.0001]
2024-12-13 22:55:39,487 - INFO - Epoch [15/100]
2024-12-13 22:56:04,182 - INFO -   Training loss: 0.3436
2024-12-13 22:56:22,471 - INFO -   Validation loss: 0.7749
2024-12-13 22:56:22,471 - INFO -   Validation accuracy: 70.84%
2024-12-13 22:56:22,471 - INFO -   Learning rate: [0.0001]
2024-12-13 22:56:22,471 - INFO - Epoch [16/100]
2024-12-13 22:56:46,700 - INFO -   Training loss: 0.3503
2024-12-13 22:57:04,880 - INFO -   Validation loss: 0.8785
2024-12-13 22:57:04,880 - INFO -   Validation accuracy: 67.09%
2024-12-13 22:57:04,880 - INFO -   Learning rate: [1e-05]
2024-12-13 22:57:04,880 - INFO - Epoch [17/100]
2024-12-13 22:57:29,765 - INFO -   Training loss: 0.2904
2024-12-13 22:57:48,116 - INFO -   Validation loss: 0.8181
2024-12-13 22:57:48,116 - INFO -   Validation accuracy: 67.61%
2024-12-13 22:57:48,116 - INFO -   Learning rate: [1e-05]
2024-12-13 22:57:48,117 - INFO - Epoch [18/100]
2024-12-13 22:58:12,685 - INFO -   Training loss: 0.3065
2024-12-13 22:58:31,206 - INFO -   Validation loss: 0.7949
2024-12-13 22:58:31,207 - INFO -   Validation accuracy: 68.37%
2024-12-13 22:58:31,207 - INFO -   Learning rate: [1e-05]
2024-12-13 22:58:31,207 - INFO - Epoch [19/100]
2024-12-13 22:58:56,254 - INFO -   Training loss: 0.2972
2024-12-13 22:59:14,509 - INFO -   Validation loss: 0.8089
2024-12-13 22:59:14,509 - INFO -   Validation accuracy: 68.29%
2024-12-13 22:59:14,509 - INFO -   Learning rate: [1e-05]
2024-12-13 22:59:14,509 - INFO - Epoch [20/100]
2024-12-13 22:59:38,604 - INFO -   Training loss: 0.2744
2024-12-13 22:59:56,924 - INFO -   Validation loss: 0.7583
2024-12-13 22:59:56,924 - INFO -   Validation accuracy: 70.48%
2024-12-13 22:59:56,924 - INFO -   Learning rate: [1e-05]
2024-12-13 22:59:56,958 - INFO - Epoch [21/100]
2024-12-13 23:00:21,251 - INFO -   Training loss: 0.2676
2024-12-13 23:00:39,823 - INFO -   Validation loss: 0.7839
2024-12-13 23:00:39,823 - INFO -   Validation accuracy: 72.92%
2024-12-13 23:00:39,823 - INFO -   Learning rate: [1e-05]
2024-12-13 23:00:39,823 - INFO - Epoch [22/100]
2024-12-13 23:01:04,018 - INFO -   Training loss: 0.2681
2024-12-13 23:01:21,984 - INFO -   Validation loss: 0.7957
2024-12-13 23:01:21,984 - INFO -   Validation accuracy: 71.20%
2024-12-13 23:01:21,984 - INFO -   Learning rate: [1e-05]
2024-12-13 23:01:21,984 - INFO - Epoch [23/100]
2024-12-13 23:01:45,857 - INFO -   Training loss: 0.2676
2024-12-13 23:02:03,877 - INFO -   Validation loss: 0.8320
2024-12-13 23:02:03,877 - INFO -   Validation accuracy: 70.80%
2024-12-13 23:02:03,877 - INFO -   Learning rate: [1e-05]
2024-12-13 23:02:03,877 - INFO - Epoch [24/100]
2024-12-13 23:02:27,890 - INFO -   Training loss: 0.2581
2024-12-13 23:02:45,957 - INFO -   Validation loss: 0.8093
2024-12-13 23:02:45,957 - INFO -   Validation accuracy: 70.96%
2024-12-13 23:02:45,957 - INFO -   Learning rate: [1e-05]
2024-12-13 23:02:45,957 - INFO - Epoch [25/100]
2024-12-13 23:03:09,946 - INFO -   Training loss: 0.2584
2024-12-13 23:03:28,017 - INFO -   Validation loss: 0.7910
2024-12-13 23:03:28,017 - INFO -   Validation accuracy: 70.72%
2024-12-13 23:03:28,017 - INFO -   Learning rate: [1e-05]
2024-12-13 23:03:28,017 - INFO - Epoch [26/100]
2024-12-13 23:03:51,990 - INFO -   Training loss: 0.2530
2024-12-13 23:04:10,123 - INFO -   Validation loss: 0.7713
2024-12-13 23:04:10,123 - INFO -   Validation accuracy: 72.48%
2024-12-13 23:04:10,123 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 23:04:10,123 - INFO - Epoch [27/100]
2024-12-13 23:04:34,203 - INFO -   Training loss: 0.2513
2024-12-13 23:04:52,335 - INFO -   Validation loss: 0.7793
2024-12-13 23:04:52,335 - INFO -   Validation accuracy: 71.04%
2024-12-13 23:04:52,335 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 23:04:52,335 - INFO - Epoch [28/100]
2024-12-13 23:05:16,390 - INFO -   Training loss: 0.2475
2024-12-13 23:05:34,420 - INFO -   Validation loss: 0.7920
2024-12-13 23:05:34,420 - INFO -   Validation accuracy: 71.16%
2024-12-13 23:05:34,420 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 23:05:34,420 - INFO - Epoch [29/100]
2024-12-13 23:05:58,569 - INFO -   Training loss: 0.2513
2024-12-13 23:06:16,626 - INFO -   Validation loss: 0.7998
2024-12-13 23:06:16,626 - INFO -   Validation accuracy: 70.80%
2024-12-13 23:06:16,626 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 23:06:16,627 - INFO - Epoch [30/100]
2024-12-13 23:06:40,611 - INFO -   Training loss: 0.2488
2024-12-13 23:06:58,618 - INFO -   Validation loss: 0.7831
2024-12-13 23:06:58,618 - INFO -   Validation accuracy: 72.56%
2024-12-13 23:06:58,618 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 23:06:58,618 - INFO - Epoch [31/100]
2024-12-13 23:07:22,453 - INFO -   Training loss: 0.2561
2024-12-13 23:07:40,141 - INFO -   Validation loss: 0.8217
2024-12-13 23:07:40,141 - INFO -   Validation accuracy: 69.37%
2024-12-13 23:07:40,141 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 23:07:40,141 - INFO - Epoch [32/100]
2024-12-13 23:08:03,949 - INFO -   Training loss: 0.2487
2024-12-13 23:08:21,768 - INFO -   Validation loss: 0.7793
2024-12-13 23:08:21,768 - INFO -   Validation accuracy: 69.72%
2024-12-13 23:08:21,768 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-13 23:08:21,768 - INFO - Epoch [33/100]
2024-12-13 23:08:45,721 - INFO -   Training loss: 0.2338
2024-12-13 23:09:03,759 - INFO -   Validation loss: 0.7672
2024-12-13 23:09:03,759 - INFO -   Validation accuracy: 69.84%
2024-12-13 23:09:03,760 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-13 23:09:03,760 - INFO - Epoch [34/100]
2024-12-13 23:09:27,970 - INFO -   Training loss: 0.2517
2024-12-13 23:09:46,271 - INFO -   Validation loss: 0.7763
2024-12-13 23:09:46,271 - INFO -   Validation accuracy: 70.76%
2024-12-13 23:09:46,271 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-13 23:09:46,272 - INFO - Epoch [35/100]
2024-12-13 23:10:10,670 - INFO -   Training loss: 0.2479
2024-12-13 23:10:28,672 - INFO -   Validation loss: 0.7939
2024-12-13 23:10:28,672 - INFO -   Validation accuracy: 69.72%
2024-12-13 23:10:28,672 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-13 23:10:28,672 - INFO - Epoch [36/100]
2024-12-13 23:10:53,013 - INFO -   Training loss: 0.2558
2024-12-13 23:11:12,333 - INFO -   Validation loss: 0.8106
2024-12-13 23:11:12,333 - INFO -   Validation accuracy: 70.52%
2024-12-13 23:11:12,333 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-13 23:11:12,333 - INFO - Epoch [37/100]
2024-12-13 23:11:37,693 - INFO -   Training loss: 0.2456
2024-12-13 23:11:56,102 - INFO -   Validation loss: 0.7728
2024-12-13 23:11:56,102 - INFO -   Validation accuracy: 71.56%
2024-12-13 23:11:56,102 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-13 23:11:56,103 - INFO - Epoch [38/100]
2024-12-13 23:12:20,442 - INFO -   Training loss: 0.2530
2024-12-13 23:12:38,538 - INFO -   Validation loss: 0.7859
2024-12-13 23:12:38,538 - INFO -   Validation accuracy: 72.40%
2024-12-13 23:12:38,538 - INFO -   Learning rate: [1.0000000000000004e-08]
2024-12-13 23:12:38,538 - INFO - Epoch [39/100]
2024-12-13 23:13:02,636 - INFO -   Training loss: 0.2620
2024-12-13 23:13:20,616 - INFO -   Validation loss: 0.7650
2024-12-13 23:13:20,616 - INFO -   Validation accuracy: 71.88%
2024-12-13 23:13:20,616 - INFO -   Learning rate: [1.0000000000000004e-08]
2024-12-13 23:13:20,616 - INFO - Epoch [40/100]
2024-12-13 23:13:45,016 - INFO -   Training loss: 0.2446
2024-12-13 23:14:03,250 - INFO -   Validation loss: 0.7903
2024-12-13 23:14:03,251 - INFO -   Validation accuracy: 70.60%
2024-12-13 23:14:03,251 - INFO -   Learning rate: [1.0000000000000004e-08]
2024-12-13 23:14:03,251 - INFO -   Early stopping triggered!
2024-12-13 23:14:03,251 - INFO - Testing the model on the test set...
2024-12-13 23:14:21,418 - INFO - Confusion matrix computed.
2024-12-13 23:14:21,680 - INFO - Confusion matrix saved as confusion_matrix.png.
2024-12-13 23:14:21,685 - INFO - 
              precision    recall  f1-score   support

       akiec       0.46      0.72      0.57        72
         bcc       0.55      0.81      0.66       124
         bkl       0.46      0.69      0.55       268
          df       0.51      0.72      0.60        29
         mel       0.41      0.65      0.50       339
          nv       0.96      0.69      0.80      1637
        vasc       0.43      0.69      0.53        39

    accuracy                           0.69      2508
   macro avg       0.54      0.71      0.60      2508
weighted avg       0.78      0.69      0.71      2508

2024-12-13 23:17:11,894 - INFO - Starting the training script.
2024-12-13 23:17:11,907 - INFO - Using device: cuda
2024-12-13 23:17:11,907 - INFO - Preparing DataLoaders...
2024-12-13 23:17:11,926 - INFO - Training samples: 5000
2024-12-13 23:17:11,926 - INFO - Validation samples: 2507
2024-12-13 23:17:11,926 - INFO - Testing samples: 2508
2024-12-13 23:17:11,926 - INFO - Loading model: densenet121...
2024-12-13 23:17:12,675 - INFO - Model loaded successfully.
2024-12-13 23:17:12,678 - INFO - Loss function, optimizer, and scheduler defined.
2024-12-13 23:17:12,678 - INFO - Epoch [1/100]
2024-12-13 23:17:38,367 - INFO -   Training loss: 1.3661
2024-12-13 23:17:56,923 - INFO -   Validation loss: 1.0855
2024-12-13 23:17:56,923 - INFO -   Validation accuracy: 52.25%
2024-12-13 23:17:56,923 - INFO -   Learning rate: [0.0001]
2024-12-13 23:17:56,998 - INFO - Epoch [2/100]
2024-12-13 23:18:21,436 - INFO -   Training loss: 0.8460
2024-12-13 23:18:39,830 - INFO -   Validation loss: 0.8868
2024-12-13 23:18:39,830 - INFO -   Validation accuracy: 59.27%
2024-12-13 23:18:39,830 - INFO -   Learning rate: [0.0001]
2024-12-13 23:18:39,890 - INFO - Epoch [3/100]
2024-12-13 23:19:04,517 - INFO -   Training loss: 0.6753
2024-12-13 23:19:22,609 - INFO -   Validation loss: 0.8316
2024-12-13 23:19:22,609 - INFO -   Validation accuracy: 63.74%
2024-12-13 23:19:22,609 - INFO -   Learning rate: [0.0001]
2024-12-13 23:19:22,669 - INFO - Epoch [4/100]
2024-12-13 23:19:47,610 - INFO -   Training loss: 0.5903
2024-12-13 23:20:06,011 - INFO -   Validation loss: 0.8215
2024-12-13 23:20:06,011 - INFO -   Validation accuracy: 65.42%
2024-12-13 23:20:06,011 - INFO -   Learning rate: [0.0001]
2024-12-13 23:20:06,074 - INFO - Epoch [5/100]
2024-12-13 23:20:30,744 - INFO -   Training loss: 0.5080
2024-12-13 23:20:48,924 - INFO -   Validation loss: 0.7837
2024-12-13 23:20:48,924 - INFO -   Validation accuracy: 66.29%
2024-12-13 23:20:48,924 - INFO -   Learning rate: [0.0001]
2024-12-13 23:20:48,989 - INFO - Epoch [6/100]
2024-12-13 23:21:13,754 - INFO -   Training loss: 0.4775
2024-12-13 23:21:31,972 - INFO -   Validation loss: 0.7851
2024-12-13 23:21:31,972 - INFO -   Validation accuracy: 64.86%
2024-12-13 23:21:31,972 - INFO -   Learning rate: [0.0001]
2024-12-13 23:21:31,972 - INFO - Epoch [7/100]
2024-12-13 23:21:56,418 - INFO -   Training loss: 0.3827
2024-12-13 23:22:14,718 - INFO -   Validation loss: 0.7090
2024-12-13 23:22:14,718 - INFO -   Validation accuracy: 72.56%
2024-12-13 23:22:14,718 - INFO -   Learning rate: [0.0001]
2024-12-13 23:22:14,784 - INFO - Epoch [8/100]
2024-12-13 23:22:39,386 - INFO -   Training loss: 0.4281
2024-12-13 23:22:57,772 - INFO -   Validation loss: 0.7163
2024-12-13 23:22:57,772 - INFO -   Validation accuracy: 73.91%
2024-12-13 23:22:57,772 - INFO -   Learning rate: [0.0001]
2024-12-13 23:22:57,772 - INFO - Epoch [9/100]
2024-12-13 23:23:22,524 - INFO -   Training loss: 0.3241
2024-12-13 23:23:41,275 - INFO -   Validation loss: 0.8301
2024-12-13 23:23:41,275 - INFO -   Validation accuracy: 72.80%
2024-12-13 23:23:41,275 - INFO -   Learning rate: [0.0001]
2024-12-13 23:23:41,275 - INFO - Epoch [10/100]
2024-12-13 23:24:06,205 - INFO -   Training loss: 0.3161
2024-12-13 23:24:24,883 - INFO -   Validation loss: 0.8610
2024-12-13 23:24:24,883 - INFO -   Validation accuracy: 68.81%
2024-12-13 23:24:24,883 - INFO -   Learning rate: [0.0001]
2024-12-13 23:24:24,883 - INFO - Epoch [11/100]
2024-12-13 23:24:49,673 - INFO -   Training loss: 0.2890
2024-12-13 23:25:07,825 - INFO -   Validation loss: 0.7947
2024-12-13 23:25:07,825 - INFO -   Validation accuracy: 76.63%
2024-12-13 23:25:07,825 - INFO -   Learning rate: [0.0001]
2024-12-13 23:25:07,825 - INFO - Epoch [12/100]
2024-12-13 23:25:32,280 - INFO -   Training loss: 0.2836
2024-12-13 23:25:50,340 - INFO -   Validation loss: 0.8029
2024-12-13 23:25:50,340 - INFO -   Validation accuracy: 71.56%
2024-12-13 23:25:50,340 - INFO -   Learning rate: [0.0001]
2024-12-13 23:25:50,340 - INFO - Epoch [13/100]
2024-12-13 23:26:14,983 - INFO -   Training loss: 0.3000
2024-12-13 23:26:33,126 - INFO -   Validation loss: 0.8703
2024-12-13 23:26:33,126 - INFO -   Validation accuracy: 68.97%
2024-12-13 23:26:33,127 - INFO -   Learning rate: [1e-05]
2024-12-13 23:26:33,127 - INFO - Epoch [14/100]
2024-12-13 23:26:58,260 - INFO -   Training loss: 0.2385
2024-12-13 23:27:16,549 - INFO -   Validation loss: 0.8227
2024-12-13 23:27:16,549 - INFO -   Validation accuracy: 74.35%
2024-12-13 23:27:16,549 - INFO -   Learning rate: [1e-05]
2024-12-13 23:27:16,549 - INFO - Epoch [15/100]
2024-12-13 23:27:42,070 - INFO -   Training loss: 0.2001
2024-12-13 23:28:00,015 - INFO -   Validation loss: 0.7762
2024-12-13 23:28:00,015 - INFO -   Validation accuracy: 75.07%
2024-12-13 23:28:00,015 - INFO -   Learning rate: [1e-05]
2024-12-13 23:28:00,015 - INFO - Epoch [16/100]
2024-12-13 23:28:24,329 - INFO -   Training loss: 0.1933
2024-12-13 23:28:42,689 - INFO -   Validation loss: 0.7324
2024-12-13 23:28:42,689 - INFO -   Validation accuracy: 78.34%
2024-12-13 23:28:42,689 - INFO -   Learning rate: [1e-05]
2024-12-13 23:28:42,689 - INFO - Epoch [17/100]
2024-12-13 23:29:07,316 - INFO -   Training loss: 0.1838
2024-12-13 23:29:25,382 - INFO -   Validation loss: 0.7981
2024-12-13 23:29:25,382 - INFO -   Validation accuracy: 77.66%
2024-12-13 23:29:25,382 - INFO -   Learning rate: [1e-05]
2024-12-13 23:29:25,382 - INFO - Epoch [18/100]
2024-12-13 23:29:50,081 - INFO -   Training loss: 0.1850
2024-12-13 23:30:08,447 - INFO -   Validation loss: 0.8049
2024-12-13 23:30:08,447 - INFO -   Validation accuracy: 77.18%
2024-12-13 23:30:08,447 - INFO -   Learning rate: [1e-05]
2024-12-13 23:30:08,448 - INFO - Epoch [19/100]
2024-12-13 23:30:34,187 - INFO -   Training loss: 0.1756
2024-12-13 23:30:52,342 - INFO -   Validation loss: 0.7705
2024-12-13 23:30:52,343 - INFO -   Validation accuracy: 79.14%
2024-12-13 23:30:52,343 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 23:30:52,343 - INFO - Epoch [20/100]
2024-12-13 23:31:17,717 - INFO -   Training loss: 0.1681
2024-12-13 23:31:35,891 - INFO -   Validation loss: 0.8075
2024-12-13 23:31:35,891 - INFO -   Validation accuracy: 75.63%
2024-12-13 23:31:35,891 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 23:31:35,891 - INFO - Epoch [21/100]
2024-12-13 23:32:01,657 - INFO -   Training loss: 0.1726
2024-12-13 23:32:20,010 - INFO -   Validation loss: 0.7820
2024-12-13 23:32:20,010 - INFO -   Validation accuracy: 77.02%
2024-12-13 23:32:20,011 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 23:32:20,011 - INFO - Epoch [22/100]
2024-12-13 23:32:47,285 - INFO -   Training loss: 0.1611
2024-12-13 23:33:06,561 - INFO -   Validation loss: 0.7711
2024-12-13 23:33:06,561 - INFO -   Validation accuracy: 78.10%
2024-12-13 23:33:06,561 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 23:33:06,562 - INFO - Epoch [23/100]
2024-12-13 23:33:31,515 - INFO -   Training loss: 0.1653
2024-12-13 23:33:51,156 - INFO -   Validation loss: 0.8217
2024-12-13 23:33:51,156 - INFO -   Validation accuracy: 75.91%
2024-12-13 23:33:51,156 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 23:33:51,156 - INFO - Epoch [24/100]
2024-12-13 23:34:16,103 - INFO -   Training loss: 0.1627
2024-12-13 23:34:34,697 - INFO -   Validation loss: 0.7896
2024-12-13 23:34:34,697 - INFO -   Validation accuracy: 76.94%
2024-12-13 23:34:34,697 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-13 23:34:34,697 - INFO - Epoch [25/100]
2024-12-13 23:35:01,245 - INFO -   Training loss: 0.1573
2024-12-13 23:35:19,796 - INFO -   Validation loss: 0.7824
2024-12-13 23:35:19,796 - INFO -   Validation accuracy: 77.86%
2024-12-13 23:35:19,796 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-13 23:35:19,796 - INFO - Epoch [26/100]
2024-12-13 23:35:45,167 - INFO -   Training loss: 0.1601
2024-12-13 23:36:03,911 - INFO -   Validation loss: 0.7836
2024-12-13 23:36:03,911 - INFO -   Validation accuracy: 77.22%
2024-12-13 23:36:03,911 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-13 23:36:03,911 - INFO - Epoch [27/100]
2024-12-13 23:36:29,371 - INFO -   Training loss: 0.1800
2024-12-13 23:36:47,887 - INFO -   Validation loss: 0.7904
2024-12-13 23:36:47,888 - INFO -   Validation accuracy: 78.14%
2024-12-13 23:36:47,888 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-13 23:36:47,888 - INFO -   Early stopping triggered!
2024-12-13 23:36:47,888 - INFO - Testing the model on the test set...
2024-12-13 23:37:06,891 - INFO - Confusion matrix computed.
2024-12-13 23:37:07,250 - INFO - Confusion matrix saved as confusion_matrix.png.
2024-12-13 23:37:07,255 - INFO - 
              precision    recall  f1-score   support

       akiec       0.39      0.81      0.52        72
         bcc       0.60      0.78      0.68       124
         bkl       0.62      0.62      0.62       268
          df       0.51      0.69      0.59        29
         mel       0.51      0.70      0.59       339
          nv       0.95      0.81      0.87      1637
        vasc       0.77      0.77      0.77        39

    accuracy                           0.77      2508
   macro avg       0.62      0.74      0.66      2508
weighted avg       0.81      0.77      0.78      2508

2024-12-13 23:38:27,944 - INFO - Starting the training script.
2024-12-13 23:38:27,957 - INFO - Using device: cuda
2024-12-13 23:38:27,957 - INFO - Preparing DataLoaders...
2024-12-13 23:38:27,977 - INFO - Training samples: 5000
2024-12-13 23:38:27,977 - INFO - Validation samples: 2507
2024-12-13 23:38:27,977 - INFO - Testing samples: 2508
2024-12-13 23:38:27,977 - INFO - Loading model: vgg16...
2024-12-13 23:38:33,880 - INFO - Model loaded successfully.
2024-12-13 23:38:33,883 - INFO - Loss function, optimizer, and scheduler defined.
2024-12-13 23:38:33,884 - INFO - Epoch [1/100]
2024-12-13 23:39:06,335 - INFO -   Training loss: 1.7342
2024-12-13 23:39:25,239 - INFO -   Validation loss: 1.3366
2024-12-13 23:39:25,239 - INFO -   Validation accuracy: 51.70%
2024-12-13 23:39:25,240 - INFO -   Learning rate: [0.0001]
2024-12-13 23:39:26,860 - INFO - Epoch [2/100]
2024-12-13 23:39:58,062 - INFO -   Training loss: 1.2643
2024-12-13 23:40:17,617 - INFO -   Validation loss: 1.2764
2024-12-13 23:40:17,617 - INFO -   Validation accuracy: 63.42%
2024-12-13 23:40:17,617 - INFO -   Learning rate: [0.0001]
2024-12-13 23:40:19,236 - INFO - Epoch [3/100]
2024-12-13 23:40:50,031 - INFO -   Training loss: 1.3099
2024-12-13 23:41:09,177 - INFO -   Validation loss: 1.7415
2024-12-13 23:41:09,177 - INFO -   Validation accuracy: 31.19%
2024-12-13 23:41:09,177 - INFO -   Learning rate: [0.0001]
2024-12-13 23:41:09,177 - INFO - Epoch [4/100]
2024-12-13 23:41:39,655 - INFO -   Training loss: 1.1433
2024-12-13 23:41:58,251 - INFO -   Validation loss: 1.5314
2024-12-13 23:41:58,251 - INFO -   Validation accuracy: 64.74%
2024-12-13 23:41:58,251 - INFO -   Learning rate: [0.0001]
2024-12-13 23:41:58,251 - INFO - Epoch [5/100]
2024-12-13 23:42:28,976 - INFO -   Training loss: 1.0552
2024-12-13 23:42:47,537 - INFO -   Validation loss: 1.0012
2024-12-13 23:42:47,537 - INFO -   Validation accuracy: 64.74%
2024-12-13 23:42:47,537 - INFO -   Learning rate: [0.0001]
2024-12-13 23:42:49,150 - INFO - Epoch [6/100]
2024-12-13 23:43:20,379 - INFO -   Training loss: 0.9883
2024-12-13 23:43:39,399 - INFO -   Validation loss: 1.1058
2024-12-13 23:43:39,399 - INFO -   Validation accuracy: 55.01%
2024-12-13 23:43:39,400 - INFO -   Learning rate: [0.0001]
2024-12-13 23:43:39,400 - INFO - Epoch [7/100]
2024-12-13 23:44:10,047 - INFO -   Training loss: 0.9264
2024-12-13 23:44:29,061 - INFO -   Validation loss: 1.1024
2024-12-13 23:44:29,061 - INFO -   Validation accuracy: 62.35%
2024-12-13 23:44:29,061 - INFO -   Learning rate: [0.0001]
2024-12-13 23:44:29,061 - INFO - Epoch [8/100]
2024-12-13 23:44:59,715 - INFO -   Training loss: 0.9995
2024-12-13 23:45:18,228 - INFO -   Validation loss: 1.0287
2024-12-13 23:45:18,229 - INFO -   Validation accuracy: 64.10%
2024-12-13 23:45:18,229 - INFO -   Learning rate: [0.0001]
2024-12-13 23:45:18,229 - INFO - Epoch [9/100]
2024-12-13 23:45:48,023 - INFO -   Training loss: 0.8797
2024-12-13 23:46:06,791 - INFO -   Validation loss: 0.9747
2024-12-13 23:46:06,791 - INFO -   Validation accuracy: 55.88%
2024-12-13 23:46:06,791 - INFO -   Learning rate: [0.0001]
2024-12-13 23:46:08,405 - INFO - Epoch [10/100]
2024-12-13 23:46:44,335 - INFO -   Training loss: 0.8290
2024-12-13 23:47:06,260 - INFO -   Validation loss: 1.0696
2024-12-13 23:47:06,260 - INFO -   Validation accuracy: 46.95%
2024-12-13 23:47:06,260 - INFO -   Learning rate: [0.0001]
2024-12-13 23:47:06,260 - INFO - Epoch [11/100]
2024-12-13 23:47:42,473 - INFO -   Training loss: 0.8163
2024-12-13 23:48:04,554 - INFO -   Validation loss: 1.1023
2024-12-13 23:48:04,554 - INFO -   Validation accuracy: 63.98%
2024-12-13 23:48:04,554 - INFO -   Learning rate: [0.0001]
2024-12-13 23:48:04,554 - INFO - Epoch [12/100]
2024-12-13 23:48:40,269 - INFO -   Training loss: 0.7807
2024-12-13 23:49:02,056 - INFO -   Validation loss: 1.0948
2024-12-13 23:49:02,056 - INFO -   Validation accuracy: 50.46%
2024-12-13 23:49:02,056 - INFO -   Learning rate: [0.0001]
2024-12-13 23:49:02,056 - INFO - Epoch [13/100]
2024-12-13 23:49:38,059 - INFO -   Training loss: 0.7638
2024-12-13 23:49:59,989 - INFO -   Validation loss: 1.0433
2024-12-13 23:49:59,990 - INFO -   Validation accuracy: 58.88%
2024-12-13 23:49:59,990 - INFO -   Learning rate: [0.0001]
2024-12-13 23:49:59,990 - INFO - Epoch [14/100]
2024-12-13 23:50:36,264 - INFO -   Training loss: 0.7058
2024-12-13 23:50:58,340 - INFO -   Validation loss: 0.9444
2024-12-13 23:50:58,340 - INFO -   Validation accuracy: 66.81%
2024-12-13 23:50:58,340 - INFO -   Learning rate: [0.0001]
2024-12-13 23:51:00,262 - INFO - Epoch [15/100]
2024-12-13 23:51:36,108 - INFO -   Training loss: 0.6482
2024-12-13 23:51:58,038 - INFO -   Validation loss: 1.0041
2024-12-13 23:51:58,038 - INFO -   Validation accuracy: 56.72%
2024-12-13 23:51:58,038 - INFO -   Learning rate: [0.0001]
2024-12-13 23:51:58,038 - INFO - Epoch [16/100]
2024-12-13 23:52:33,966 - INFO -   Training loss: 0.6665
2024-12-13 23:52:56,174 - INFO -   Validation loss: 1.1027
2024-12-13 23:52:56,174 - INFO -   Validation accuracy: 65.02%
2024-12-13 23:52:56,174 - INFO -   Learning rate: [0.0001]
2024-12-13 23:52:56,174 - INFO - Epoch [17/100]
2024-12-13 23:53:32,237 - INFO -   Training loss: 0.5643
2024-12-13 23:53:54,347 - INFO -   Validation loss: 1.1595
2024-12-13 23:53:54,347 - INFO -   Validation accuracy: 56.52%
2024-12-13 23:53:54,347 - INFO -   Learning rate: [0.0001]
2024-12-13 23:53:54,348 - INFO - Epoch [18/100]
2024-12-13 23:54:25,689 - INFO -   Training loss: 0.5887
2024-12-13 23:54:47,543 - INFO -   Validation loss: 0.9353
2024-12-13 23:54:47,543 - INFO -   Validation accuracy: 51.81%
2024-12-13 23:54:47,543 - INFO -   Learning rate: [0.0001]
2024-12-13 23:54:49,341 - INFO - Epoch [19/100]
2024-12-13 23:55:24,829 - INFO -   Training loss: 0.6923
2024-12-13 23:55:46,364 - INFO -   Validation loss: 1.0731
2024-12-13 23:55:46,365 - INFO -   Validation accuracy: 60.95%
2024-12-13 23:55:46,365 - INFO -   Learning rate: [0.0001]
2024-12-13 23:55:46,365 - INFO - Epoch [20/100]
2024-12-13 23:56:22,891 - INFO -   Training loss: 0.5944
2024-12-13 23:56:44,483 - INFO -   Validation loss: 1.0327
2024-12-13 23:56:44,483 - INFO -   Validation accuracy: 65.22%
2024-12-13 23:56:44,483 - INFO -   Learning rate: [0.0001]
2024-12-13 23:56:44,484 - INFO - Epoch [21/100]
2024-12-13 23:57:20,083 - INFO -   Training loss: 0.5363
2024-12-13 23:57:41,749 - INFO -   Validation loss: 1.1091
2024-12-13 23:57:41,749 - INFO -   Validation accuracy: 57.72%
2024-12-13 23:57:41,749 - INFO -   Learning rate: [0.0001]
2024-12-13 23:57:41,749 - INFO - Epoch [22/100]
2024-12-13 23:58:17,722 - INFO -   Training loss: 0.6552
2024-12-13 23:58:38,924 - INFO -   Validation loss: 0.9104
2024-12-13 23:58:38,924 - INFO -   Validation accuracy: 72.36%
2024-12-13 23:58:38,924 - INFO -   Learning rate: [0.0001]
2024-12-13 23:58:40,545 - INFO - Epoch [23/100]
2024-12-13 23:59:11,334 - INFO -   Training loss: 0.6444
2024-12-13 23:59:29,781 - INFO -   Validation loss: 1.1561
2024-12-13 23:59:29,781 - INFO -   Validation accuracy: 63.74%
2024-12-13 23:59:29,781 - INFO -   Learning rate: [0.0001]
2024-12-13 23:59:29,781 - INFO - Epoch [24/100]
2024-12-14 00:00:00,159 - INFO -   Training loss: 0.5455
2024-12-14 00:00:18,383 - INFO -   Validation loss: 0.8934
2024-12-14 00:00:18,383 - INFO -   Validation accuracy: 63.70%
2024-12-14 00:00:18,383 - INFO -   Learning rate: [0.0001]
2024-12-14 00:00:19,986 - INFO - Epoch [25/100]
2024-12-14 00:00:50,262 - INFO -   Training loss: 0.4834
2024-12-14 00:01:08,595 - INFO -   Validation loss: 1.0851
2024-12-14 00:01:08,595 - INFO -   Validation accuracy: 64.46%
2024-12-14 00:01:08,596 - INFO -   Learning rate: [0.0001]
2024-12-14 00:01:08,596 - INFO - Epoch [26/100]
2024-12-14 00:01:39,163 - INFO -   Training loss: 0.6451
2024-12-14 00:01:57,969 - INFO -   Validation loss: 0.8897
2024-12-14 00:01:57,969 - INFO -   Validation accuracy: 59.23%
2024-12-14 00:01:57,969 - INFO -   Learning rate: [0.0001]
2024-12-14 00:01:59,591 - INFO - Epoch [27/100]
2024-12-14 00:02:29,769 - INFO -   Training loss: 0.5528
2024-12-14 00:02:47,999 - INFO -   Validation loss: 0.9441
2024-12-14 00:02:47,999 - INFO -   Validation accuracy: 58.64%
2024-12-14 00:02:47,999 - INFO -   Learning rate: [0.0001]
2024-12-14 00:02:47,999 - INFO - Epoch [28/100]
2024-12-14 00:03:18,403 - INFO -   Training loss: 0.5625
2024-12-14 00:03:36,558 - INFO -   Validation loss: 1.1508
2024-12-14 00:03:36,558 - INFO -   Validation accuracy: 72.08%
2024-12-14 00:03:36,558 - INFO -   Learning rate: [0.0001]
2024-12-14 00:03:36,558 - INFO - Epoch [29/100]
2024-12-14 00:04:06,459 - INFO -   Training loss: 0.4788
2024-12-14 00:04:24,770 - INFO -   Validation loss: 1.0023
2024-12-14 00:04:24,770 - INFO -   Validation accuracy: 69.57%
2024-12-14 00:04:24,770 - INFO -   Learning rate: [0.0001]
2024-12-14 00:04:24,770 - INFO - Epoch [30/100]
2024-12-14 00:04:54,882 - INFO -   Training loss: 0.4111
2024-12-14 00:05:13,317 - INFO -   Validation loss: 1.1506
2024-12-14 00:05:13,317 - INFO -   Validation accuracy: 70.84%
2024-12-14 00:05:13,317 - INFO -   Learning rate: [0.0001]
2024-12-14 00:05:13,318 - INFO - Epoch [31/100]
2024-12-14 00:05:43,009 - INFO -   Training loss: 0.4314
2024-12-14 00:06:01,504 - INFO -   Validation loss: 0.9598
2024-12-14 00:06:01,504 - INFO -   Validation accuracy: 67.57%
2024-12-14 00:06:01,504 - INFO -   Learning rate: [0.0001]
2024-12-14 00:06:01,505 - INFO - Epoch [32/100]
2024-12-14 00:06:31,290 - INFO -   Training loss: 0.3997
2024-12-14 00:06:49,688 - INFO -   Validation loss: 1.0254
2024-12-14 00:06:49,688 - INFO -   Validation accuracy: 64.62%
2024-12-14 00:06:49,688 - INFO -   Learning rate: [1e-05]
2024-12-14 00:06:49,689 - INFO - Epoch [33/100]
2024-12-14 00:07:19,253 - INFO -   Training loss: 0.3504
2024-12-14 00:07:37,612 - INFO -   Validation loss: 0.9857
2024-12-14 00:07:37,612 - INFO -   Validation accuracy: 67.13%
2024-12-14 00:07:37,612 - INFO -   Learning rate: [1e-05]
2024-12-14 00:07:37,612 - INFO - Epoch [34/100]
2024-12-14 00:08:07,543 - INFO -   Training loss: 0.3114
2024-12-14 00:08:26,043 - INFO -   Validation loss: 0.8653
2024-12-14 00:08:26,043 - INFO -   Validation accuracy: 65.66%
2024-12-14 00:08:26,043 - INFO -   Learning rate: [1e-05]
2024-12-14 00:08:27,668 - INFO - Epoch [35/100]
2024-12-14 00:08:57,938 - INFO -   Training loss: 0.2582
2024-12-14 00:09:16,537 - INFO -   Validation loss: 0.9473
2024-12-14 00:09:16,537 - INFO -   Validation accuracy: 68.21%
2024-12-14 00:09:16,537 - INFO -   Learning rate: [1e-05]
2024-12-14 00:09:16,537 - INFO - Epoch [36/100]
2024-12-14 00:09:47,274 - INFO -   Training loss: 0.2502
2024-12-14 00:10:05,998 - INFO -   Validation loss: 0.8847
2024-12-14 00:10:05,998 - INFO -   Validation accuracy: 69.09%
2024-12-14 00:10:05,999 - INFO -   Learning rate: [1e-05]
2024-12-14 00:10:05,999 - INFO - Epoch [37/100]
2024-12-14 00:10:36,201 - INFO -   Training loss: 0.2528
2024-12-14 00:10:54,464 - INFO -   Validation loss: 0.9258
2024-12-14 00:10:54,464 - INFO -   Validation accuracy: 68.65%
2024-12-14 00:10:54,464 - INFO -   Learning rate: [1e-05]
2024-12-14 00:10:54,464 - INFO - Epoch [38/100]
2024-12-14 00:11:23,979 - INFO -   Training loss: 0.2267
2024-12-14 00:11:42,325 - INFO -   Validation loss: 0.9409
2024-12-14 00:11:42,325 - INFO -   Validation accuracy: 71.12%
2024-12-14 00:11:42,325 - INFO -   Learning rate: [1e-05]
2024-12-14 00:11:42,325 - INFO - Epoch [39/100]
2024-12-14 00:12:11,528 - INFO -   Training loss: 0.2296
2024-12-14 00:12:29,917 - INFO -   Validation loss: 0.9898
2024-12-14 00:12:29,917 - INFO -   Validation accuracy: 70.60%
2024-12-14 00:12:29,919 - INFO -   Learning rate: [1e-05]
2024-12-14 00:12:29,919 - INFO - Epoch [40/100]
2024-12-14 00:12:59,762 - INFO -   Training loss: 0.2172
2024-12-14 00:13:17,980 - INFO -   Validation loss: 1.0288
2024-12-14 00:13:17,980 - INFO -   Validation accuracy: 71.08%
2024-12-14 00:13:17,980 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-14 00:13:17,980 - INFO - Epoch [41/100]
2024-12-14 00:13:47,688 - INFO -   Training loss: 0.2126
2024-12-14 00:14:05,857 - INFO -   Validation loss: 1.0345
2024-12-14 00:14:05,857 - INFO -   Validation accuracy: 71.60%
2024-12-14 00:14:05,857 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-14 00:14:05,857 - INFO - Epoch [42/100]
2024-12-14 00:14:35,291 - INFO -   Training loss: 0.2078
2024-12-14 00:14:53,298 - INFO -   Validation loss: 1.0296
2024-12-14 00:14:53,299 - INFO -   Validation accuracy: 71.68%
2024-12-14 00:14:53,299 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-14 00:14:53,299 - INFO - Epoch [43/100]
2024-12-14 00:15:22,959 - INFO -   Training loss: 0.2178
2024-12-14 00:15:41,040 - INFO -   Validation loss: 1.0214
2024-12-14 00:15:41,040 - INFO -   Validation accuracy: 71.28%
2024-12-14 00:15:41,040 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-14 00:15:41,040 - INFO - Epoch [44/100]
2024-12-14 00:16:11,038 - INFO -   Training loss: 0.2070
2024-12-14 00:16:29,127 - INFO -   Validation loss: 1.0105
2024-12-14 00:16:29,127 - INFO -   Validation accuracy: 71.40%
2024-12-14 00:16:29,127 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-14 00:16:29,128 - INFO - Epoch [45/100]
2024-12-14 00:16:58,627 - INFO -   Training loss: 0.2178
2024-12-14 00:17:16,775 - INFO -   Validation loss: 1.0044
2024-12-14 00:17:16,775 - INFO -   Validation accuracy: 71.44%
2024-12-14 00:17:16,775 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-14 00:17:16,775 - INFO - Epoch [46/100]
2024-12-14 00:17:47,241 - INFO -   Training loss: 0.2086
2024-12-14 00:18:05,819 - INFO -   Validation loss: 0.9898
2024-12-14 00:18:05,819 - INFO -   Validation accuracy: 71.40%
2024-12-14 00:18:05,819 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-14 00:18:05,819 - INFO - Epoch [47/100]
2024-12-14 00:18:35,804 - INFO -   Training loss: 0.2103
2024-12-14 00:18:53,995 - INFO -   Validation loss: 0.9895
2024-12-14 00:18:53,996 - INFO -   Validation accuracy: 71.40%
2024-12-14 00:18:53,996 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-14 00:18:53,996 - INFO - Epoch [48/100]
2024-12-14 00:19:24,317 - INFO -   Training loss: 0.2189
2024-12-14 00:19:42,839 - INFO -   Validation loss: 0.9881
2024-12-14 00:19:42,839 - INFO -   Validation accuracy: 71.40%
2024-12-14 00:19:42,839 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-14 00:19:42,839 - INFO - Epoch [49/100]
2024-12-14 00:20:13,289 - INFO -   Training loss: 0.1938
2024-12-14 00:20:34,843 - INFO -   Validation loss: 0.9890
2024-12-14 00:20:34,844 - INFO -   Validation accuracy: 71.60%
2024-12-14 00:20:34,844 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-14 00:20:34,844 - INFO - Epoch [50/100]
2024-12-14 00:21:10,671 - INFO -   Training loss: 0.2148
2024-12-14 00:21:32,913 - INFO -   Validation loss: 0.9886
2024-12-14 00:21:32,913 - INFO -   Validation accuracy: 71.60%
2024-12-14 00:21:32,913 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-14 00:21:32,914 - INFO - Epoch [51/100]
2024-12-14 00:22:08,304 - INFO -   Training loss: 0.2099
2024-12-14 00:22:30,583 - INFO -   Validation loss: 0.9887
2024-12-14 00:22:30,583 - INFO -   Validation accuracy: 71.48%
2024-12-14 00:22:30,583 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-14 00:22:30,583 - INFO - Epoch [52/100]
2024-12-14 00:23:06,294 - INFO -   Training loss: 0.1977
2024-12-14 00:23:28,568 - INFO -   Validation loss: 0.9890
2024-12-14 00:23:28,568 - INFO -   Validation accuracy: 71.48%
2024-12-14 00:23:28,568 - INFO -   Learning rate: [1.0000000000000004e-08]
2024-12-14 00:23:28,569 - INFO - Epoch [53/100]
2024-12-14 00:24:04,627 - INFO -   Training loss: 0.2158
2024-12-14 00:24:24,442 - INFO -   Validation loss: 0.9891
2024-12-14 00:24:24,442 - INFO -   Validation accuracy: 71.48%
2024-12-14 00:24:24,442 - INFO -   Learning rate: [1.0000000000000004e-08]
2024-12-14 00:24:24,442 - INFO - Epoch [54/100]
2024-12-14 00:24:55,025 - INFO -   Training loss: 0.2008
2024-12-14 00:25:13,944 - INFO -   Validation loss: 0.9892
2024-12-14 00:25:13,944 - INFO -   Validation accuracy: 71.48%
2024-12-14 00:25:13,944 - INFO -   Learning rate: [1.0000000000000004e-08]
2024-12-14 00:25:13,944 - INFO -   Early stopping triggered!
2024-12-14 00:25:13,945 - INFO - Testing the model on the test set...
2024-12-14 00:25:32,746 - INFO - Confusion matrix computed.
2024-12-14 00:25:33,049 - INFO - Confusion matrix saved as confusion_matrix.png.
2024-12-14 00:25:33,054 - INFO - 
              precision    recall  f1-score   support

       akiec       0.50      0.71      0.59        72
         bcc       0.65      0.81      0.72       124
         bkl       0.55      0.70      0.62       268
          df       0.80      0.69      0.74        29
         mel       0.37      0.77      0.50       339
          nv       0.95      0.67      0.79      1637
        vasc       0.77      0.69      0.73        39

    accuracy                           0.70      2508
   macro avg       0.66      0.72      0.67      2508
weighted avg       0.80      0.70      0.72      2508


2024-12-14 00:33:10,274 - INFO - Starting the training script.
2024-12-14 00:33:10,287 - INFO - Using device: cuda
2024-12-14 00:33:10,287 - INFO - Preparing DataLoaders...
2024-12-14 00:33:10,307 - INFO - Training samples: 5000
2024-12-14 00:33:10,307 - INFO - Validation samples: 2507
2024-12-14 00:33:10,307 - INFO - Testing samples: 2508
2024-12-14 00:33:10,307 - INFO - Loading model: vit_b_16...
2024-12-14 00:33:11,045 - INFO - Model loaded successfully.
2024-12-14 00:33:11,048 - INFO - Loss function, optimizer, and scheduler defined.
2024-12-14 00:33:11,048 - INFO - Epoch [1/100]
2024-12-14 00:33:58,972 - INFO -   Training loss: 1.7586
2024-12-14 00:34:19,421 - INFO -   Validation loss: 1.5322
2024-12-14 00:34:19,421 - INFO -   Validation accuracy: 54.37%
2024-12-14 00:34:19,421 - INFO -   Learning rate: [0.0001]
2024-12-14 00:34:19,699 - INFO - Epoch [2/100]
2024-12-14 00:35:06,791 - INFO -   Training loss: 1.4285
2024-12-14 00:35:27,018 - INFO -   Validation loss: 1.3847
2024-12-14 00:35:27,018 - INFO -   Validation accuracy: 53.69%
2024-12-14 00:35:27,018 - INFO -   Learning rate: [0.0001]
2024-12-14 00:35:27,294 - INFO - Epoch [3/100]
2024-12-14 00:36:14,648 - INFO -   Training loss: 1.3015
2024-12-14 00:36:38,971 - INFO -   Validation loss: 1.3490
2024-12-14 00:36:38,971 - INFO -   Validation accuracy: 47.43%
2024-12-14 00:36:38,971 - INFO -   Learning rate: [0.0001]
2024-12-14 00:36:39,269 - INFO - Epoch [4/100]
2024-12-14 00:37:28,114 - INFO -   Training loss: 1.2324
2024-12-14 00:37:49,222 - INFO -   Validation loss: 1.3230
2024-12-14 00:37:49,222 - INFO -   Validation accuracy: 43.12%
2024-12-14 00:37:49,222 - INFO -   Learning rate: [0.0001]
2024-12-14 00:37:49,499 - INFO - Epoch [5/100]
2024-12-14 00:38:37,340 - INFO -   Training loss: 1.1769
2024-12-14 00:38:58,278 - INFO -   Validation loss: 1.2114
2024-12-14 00:38:58,278 - INFO -   Validation accuracy: 56.44%
2024-12-14 00:38:58,278 - INFO -   Learning rate: [0.0001]
2024-12-14 00:38:58,556 - INFO - Epoch [6/100]
2024-12-14 00:39:46,546 - INFO -   Training loss: 1.1301
2024-12-14 00:40:07,464 - INFO -   Validation loss: 1.2518
2024-12-14 00:40:07,464 - INFO -   Validation accuracy: 47.75%
2024-12-14 00:40:07,464 - INFO -   Learning rate: [0.0001]
2024-12-14 00:40:07,464 - INFO - Epoch [7/100]
2024-12-14 00:40:55,190 - INFO -   Training loss: 1.1287
2024-12-14 00:41:16,380 - INFO -   Validation loss: 1.1763
2024-12-14 00:41:16,380 - INFO -   Validation accuracy: 51.81%
2024-12-14 00:41:16,380 - INFO -   Learning rate: [0.0001]
2024-12-14 00:41:16,669 - INFO - Epoch [8/100]
2024-12-14 00:42:04,869 - INFO -   Training loss: 1.0874
2024-12-14 00:42:25,677 - INFO -   Validation loss: 1.1483
2024-12-14 00:42:25,677 - INFO -   Validation accuracy: 56.52%
2024-12-14 00:42:25,677 - INFO -   Learning rate: [0.0001]
2024-12-14 00:42:25,950 - INFO - Epoch [9/100]
2024-12-14 00:43:13,759 - INFO -   Training loss: 1.0783
2024-12-14 00:43:33,791 - INFO -   Validation loss: 1.1332
2024-12-14 00:43:33,791 - INFO -   Validation accuracy: 57.08%
2024-12-14 00:43:33,791 - INFO -   Learning rate: [0.0001]
2024-12-14 00:43:34,054 - INFO - Epoch [10/100]
2024-12-14 00:44:19,004 - INFO -   Training loss: 1.0335
2024-12-14 00:44:39,098 - INFO -   Validation loss: 1.1395
2024-12-14 00:44:39,098 - INFO -   Validation accuracy: 53.93%
2024-12-14 00:44:39,098 - INFO -   Learning rate: [0.0001]
2024-12-14 00:44:39,098 - INFO - Epoch [11/100]
2024-12-14 00:45:24,111 - INFO -   Training loss: 1.0383
2024-12-14 00:45:43,699 - INFO -   Validation loss: 1.1459
2024-12-14 00:45:43,699 - INFO -   Validation accuracy: 53.33%
2024-12-14 00:45:43,699 - INFO -   Learning rate: [0.0001]
2024-12-14 00:45:43,699 - INFO - Epoch [12/100]
2024-12-14 00:46:28,865 - INFO -   Training loss: 1.0385
2024-12-14 00:46:48,897 - INFO -   Validation loss: 1.1085
2024-12-14 00:46:48,897 - INFO -   Validation accuracy: 58.32%
2024-12-14 00:46:48,897 - INFO -   Learning rate: [0.0001]
2024-12-14 00:46:49,161 - INFO - Epoch [13/100]
2024-12-14 00:47:34,043 - INFO -   Training loss: 1.0006
2024-12-14 00:47:54,198 - INFO -   Validation loss: 1.1307
2024-12-14 00:47:54,198 - INFO -   Validation accuracy: 54.93%
2024-12-14 00:47:54,198 - INFO -   Learning rate: [0.0001]
2024-12-14 00:47:54,199 - INFO - Epoch [14/100]
2024-12-14 00:48:39,589 - INFO -   Training loss: 0.9776
2024-12-14 00:49:01,815 - INFO -   Validation loss: 1.0996
2024-12-14 00:49:01,815 - INFO -   Validation accuracy: 55.72%
2024-12-14 00:49:01,815 - INFO -   Learning rate: [0.0001]
2024-12-14 00:49:02,211 - INFO - Epoch [15/100]
2024-12-14 00:49:47,505 - INFO -   Training loss: 0.9853
2024-12-14 00:50:09,954 - INFO -   Validation loss: 1.1266
2024-12-14 00:50:09,955 - INFO -   Validation accuracy: 49.98%
2024-12-14 00:50:09,955 - INFO -   Learning rate: [0.0001]
2024-12-14 00:50:09,955 - INFO - Epoch [16/100]
2024-12-14 00:50:56,671 - INFO -   Training loss: 0.9752
2024-12-14 00:51:18,772 - INFO -   Validation loss: 1.0774
2024-12-14 00:51:18,773 - INFO -   Validation accuracy: 55.60%
2024-12-14 00:51:18,773 - INFO -   Learning rate: [0.0001]
2024-12-14 00:51:19,095 - INFO - Epoch [17/100]
2024-12-14 00:52:05,316 - INFO -   Training loss: 0.9553
2024-12-14 00:52:27,612 - INFO -   Validation loss: 1.1120
2024-12-14 00:52:27,612 - INFO -   Validation accuracy: 49.30%
2024-12-14 00:52:27,613 - INFO -   Learning rate: [0.0001]
2024-12-14 00:52:27,613 - INFO - Epoch [18/100]
2024-12-14 00:53:13,880 - INFO -   Training loss: 0.9671
2024-12-14 00:53:36,156 - INFO -   Validation loss: 1.1711
2024-12-14 00:53:36,156 - INFO -   Validation accuracy: 57.88%
2024-12-14 00:53:36,157 - INFO -   Learning rate: [0.0001]
2024-12-14 00:53:36,157 - INFO - Epoch [19/100]
2024-12-14 00:54:21,903 - INFO -   Training loss: 0.9497
2024-12-14 00:54:44,197 - INFO -   Validation loss: 1.1856
2024-12-14 00:54:44,197 - INFO -   Validation accuracy: 51.89%
2024-12-14 00:54:44,197 - INFO -   Learning rate: [0.0001]
2024-12-14 00:54:44,197 - INFO - Epoch [20/100]
2024-12-14 00:55:30,222 - INFO -   Training loss: 0.9347
2024-12-14 00:55:52,392 - INFO -   Validation loss: 1.0897
2024-12-14 00:55:52,392 - INFO -   Validation accuracy: 58.92%
2024-12-14 00:55:52,392 - INFO -   Learning rate: [0.0001]
2024-12-14 00:55:52,393 - INFO - Epoch [21/100]
2024-12-14 00:56:39,183 - INFO -   Training loss: 0.9280
2024-12-14 00:57:01,401 - INFO -   Validation loss: 1.0980
2024-12-14 00:57:01,401 - INFO -   Validation accuracy: 63.94%
2024-12-14 00:57:01,401 - INFO -   Learning rate: [0.0001]
2024-12-14 00:57:01,401 - INFO - Epoch [22/100]
2024-12-14 00:57:47,250 - INFO -   Training loss: 0.9275
2024-12-14 00:58:09,464 - INFO -   Validation loss: 1.0853
2024-12-14 00:58:09,464 - INFO -   Validation accuracy: 54.25%
2024-12-14 00:58:09,464 - INFO -   Learning rate: [1e-05]
2024-12-14 00:58:09,464 - INFO - Epoch [23/100]
2024-12-14 00:58:55,922 - INFO -   Training loss: 0.8925
2024-12-14 00:59:18,519 - INFO -   Validation loss: 1.0412
2024-12-14 00:59:18,519 - INFO -   Validation accuracy: 58.12%
2024-12-14 00:59:18,520 - INFO -   Learning rate: [1e-05]
2024-12-14 00:59:18,851 - INFO - Epoch [24/100]
2024-12-14 01:00:05,457 - INFO -   Training loss: 0.8435
2024-12-14 01:00:27,420 - INFO -   Validation loss: 1.0412
2024-12-14 01:00:27,420 - INFO -   Validation accuracy: 58.92%
2024-12-14 01:00:27,420 - INFO -   Learning rate: [1e-05]
2024-12-14 01:00:27,757 - INFO - Epoch [25/100]
2024-12-14 01:01:13,720 - INFO -   Training loss: 0.8319
2024-12-14 01:01:34,201 - INFO -   Validation loss: 1.0497
2024-12-14 01:01:34,202 - INFO -   Validation accuracy: 59.15%
2024-12-14 01:01:34,202 - INFO -   Learning rate: [1e-05]
2024-12-14 01:01:34,202 - INFO - Epoch [26/100]
2024-12-14 01:02:19,413 - INFO -   Training loss: 0.8399
2024-12-14 01:02:41,594 - INFO -   Validation loss: 1.0383
2024-12-14 01:02:41,595 - INFO -   Validation accuracy: 58.00%
2024-12-14 01:02:41,595 - INFO -   Learning rate: [1e-05]
2024-12-14 01:02:41,933 - INFO - Epoch [27/100]
2024-12-14 01:03:27,886 - INFO -   Training loss: 0.8424
2024-12-14 01:03:50,344 - INFO -   Validation loss: 1.0441
2024-12-14 01:03:50,344 - INFO -   Validation accuracy: 58.36%
2024-12-14 01:03:50,344 - INFO -   Learning rate: [1e-05]
2024-12-14 01:03:50,344 - INFO - Epoch [28/100]
2024-12-14 01:04:36,665 - INFO -   Training loss: 0.8345
2024-12-14 01:04:59,090 - INFO -   Validation loss: 1.0292
2024-12-14 01:04:59,090 - INFO -   Validation accuracy: 57.12%
2024-12-14 01:04:59,090 - INFO -   Learning rate: [1e-05]
2024-12-14 01:04:59,445 - INFO - Epoch [29/100]
2024-12-14 01:05:45,247 - INFO -   Training loss: 0.8182
2024-12-14 01:06:04,928 - INFO -   Validation loss: 1.0406
2024-12-14 01:06:04,928 - INFO -   Validation accuracy: 57.56%
2024-12-14 01:06:04,928 - INFO -   Learning rate: [1e-05]
2024-12-14 01:06:04,928 - INFO - Epoch [30/100]
2024-12-14 01:06:49,795 - INFO -   Training loss: 0.8127
2024-12-14 01:07:09,972 - INFO -   Validation loss: 1.0486
2024-12-14 01:07:09,972 - INFO -   Validation accuracy: 57.36%
2024-12-14 01:07:09,972 - INFO -   Learning rate: [1e-05]
2024-12-14 01:07:09,972 - INFO - Epoch [31/100]
2024-12-14 01:07:56,526 - INFO -   Training loss: 0.8328
2024-12-14 01:08:16,524 - INFO -   Validation loss: 1.0478
2024-12-14 01:08:16,524 - INFO -   Validation accuracy: 56.84%
2024-12-14 01:08:16,524 - INFO -   Learning rate: [1e-05]
2024-12-14 01:08:16,524 - INFO - Epoch [32/100]
2024-12-14 01:09:01,822 - INFO -   Training loss: 0.8191
2024-12-14 01:09:21,963 - INFO -   Validation loss: 1.0522
2024-12-14 01:09:21,963 - INFO -   Validation accuracy: 57.96%
2024-12-14 01:09:21,963 - INFO -   Learning rate: [1e-05]
2024-12-14 01:09:21,964 - INFO - Epoch [33/100]
2024-12-14 01:10:07,047 - INFO -   Training loss: 0.8153
2024-12-14 01:10:26,789 - INFO -   Validation loss: 1.0315
2024-12-14 01:10:26,789 - INFO -   Validation accuracy: 58.36%
2024-12-14 01:10:26,789 - INFO -   Learning rate: [1e-05]
2024-12-14 01:10:26,789 - INFO - Epoch [34/100]
2024-12-14 01:11:13,589 - INFO -   Training loss: 0.8218
2024-12-14 01:11:33,977 - INFO -   Validation loss: 1.0369
2024-12-14 01:11:33,977 - INFO -   Validation accuracy: 58.92%
2024-12-14 01:11:33,977 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-14 01:11:33,977 - INFO - Epoch [35/100]
2024-12-14 01:12:19,712 - INFO -   Training loss: 0.8006
2024-12-14 01:12:39,607 - INFO -   Validation loss: 1.0353
2024-12-14 01:12:39,607 - INFO -   Validation accuracy: 58.60%
2024-12-14 01:12:39,607 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-14 01:12:39,607 - INFO - Epoch [36/100]
2024-12-14 01:13:24,493 - INFO -   Training loss: 0.8023
2024-12-14 01:13:44,263 - INFO -   Validation loss: 1.0353
2024-12-14 01:13:44,264 - INFO -   Validation accuracy: 58.68%
2024-12-14 01:13:44,264 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-14 01:13:44,264 - INFO - Epoch [37/100]
2024-12-14 01:14:29,454 - INFO -   Training loss: 0.7866
2024-12-14 01:14:48,978 - INFO -   Validation loss: 1.0344
2024-12-14 01:14:48,978 - INFO -   Validation accuracy: 58.52%
2024-12-14 01:14:48,978 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-14 01:14:48,978 - INFO - Epoch [38/100]
2024-12-14 01:15:33,730 - INFO -   Training loss: 0.8089
2024-12-14 01:15:53,503 - INFO -   Validation loss: 1.0337
2024-12-14 01:15:53,503 - INFO -   Validation accuracy: 58.48%
2024-12-14 01:15:53,503 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-14 01:15:53,503 - INFO - Epoch [39/100]
2024-12-14 01:16:37,833 - INFO -   Training loss: 0.7889
2024-12-14 01:16:58,319 - INFO -   Validation loss: 1.0342
2024-12-14 01:16:58,319 - INFO -   Validation accuracy: 58.36%
2024-12-14 01:16:58,319 - INFO -   Learning rate: [1.0000000000000002e-06]
2024-12-14 01:16:58,319 - INFO - Epoch [40/100]
2024-12-14 01:17:44,043 - INFO -   Training loss: 0.8051
2024-12-14 01:18:06,409 - INFO -   Validation loss: 1.0336
2024-12-14 01:18:06,410 - INFO -   Validation accuracy: 58.32%
2024-12-14 01:18:06,410 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-14 01:18:06,410 - INFO - Epoch [41/100]
2024-12-14 01:18:52,484 - INFO -   Training loss: 0.7906
2024-12-14 01:19:14,093 - INFO -   Validation loss: 1.0335
2024-12-14 01:19:14,094 - INFO -   Validation accuracy: 58.32%
2024-12-14 01:19:14,094 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-14 01:19:14,094 - INFO - Epoch [42/100]
2024-12-14 01:19:59,505 - INFO -   Training loss: 0.8024
2024-12-14 01:20:21,429 - INFO -   Validation loss: 1.0336
2024-12-14 01:20:21,429 - INFO -   Validation accuracy: 58.28%
2024-12-14 01:20:21,429 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-14 01:20:21,429 - INFO - Epoch [43/100]
2024-12-14 01:21:03,620 - INFO -   Training loss: 0.8012
2024-12-14 01:21:22,547 - INFO -   Validation loss: 1.0338
2024-12-14 01:21:22,547 - INFO -   Validation accuracy: 58.24%
2024-12-14 01:21:22,549 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-14 01:21:22,549 - INFO - Epoch [44/100]
2024-12-14 01:22:04,936 - INFO -   Training loss: 0.7884
2024-12-14 01:22:24,012 - INFO -   Validation loss: 1.0341
2024-12-14 01:22:24,012 - INFO -   Validation accuracy: 58.32%
2024-12-14 01:22:24,012 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-14 01:22:24,012 - INFO - Epoch [45/100]
2024-12-14 01:23:05,648 - INFO -   Training loss: 0.7968
2024-12-14 01:23:24,497 - INFO -   Validation loss: 1.0341
2024-12-14 01:23:24,498 - INFO -   Validation accuracy: 58.24%
2024-12-14 01:23:24,498 - INFO -   Learning rate: [1.0000000000000002e-07]
2024-12-14 01:23:24,498 - INFO - Epoch [46/100]
2024-12-14 01:24:06,401 - INFO -   Training loss: 0.8031
2024-12-14 01:24:26,219 - INFO -   Validation loss: 1.0340
2024-12-14 01:24:26,219 - INFO -   Validation accuracy: 58.28%
2024-12-14 01:24:26,219 - INFO -   Learning rate: [1.0000000000000004e-08]
2024-12-14 01:24:26,219 - INFO - Epoch [47/100]
2024-12-14 01:25:08,737 - INFO -   Training loss: 0.7792
2024-12-14 01:25:27,827 - INFO -   Validation loss: 1.0340
2024-12-14 01:25:27,827 - INFO -   Validation accuracy: 58.28%
2024-12-14 01:25:27,827 - INFO -   Learning rate: [1.0000000000000004e-08]
2024-12-14 01:25:27,827 - INFO - Epoch [48/100]
2024-12-14 01:26:10,051 - INFO -   Training loss: 0.7938
2024-12-14 01:26:28,707 - INFO -   Validation loss: 1.0340
2024-12-14 01:26:28,707 - INFO -   Validation accuracy: 58.28%
2024-12-14 01:26:28,707 - INFO -   Learning rate: [1.0000000000000004e-08]
2024-12-14 01:26:28,707 - INFO -   Early stopping triggered!
2024-12-14 01:26:28,707 - INFO - Testing the model on the test set...
2024-12-14 01:26:47,709 - INFO - Confusion matrix computed.
2024-12-14 01:26:48,117 - INFO - Confusion matrix saved as confusion_matrix.png.
2024-12-14 01:26:48,123 - INFO - 
              precision    recall  f1-score   support

       akiec       0.20      0.62      0.30        72
         bcc       0.30      0.72      0.42       124
         bkl       0.46      0.39      0.43       268
          df       0.24      0.45      0.31        29
         mel       0.31      0.60      0.41       339
          nv       0.96      0.59      0.73      1637
        vasc       0.64      0.72      0.67        39

    accuracy                           0.58      2508
   macro avg       0.45      0.59      0.47      2508
weighted avg       0.75      0.58      0.62      2508

